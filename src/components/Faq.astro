<section class=" bg-[#4F67FF] text-[#0a0a0a] antialiased relative py-10 sm:py-14">
  <div class="pointer-events-none absolute inset-0">
    <div
      class="absolute -top-2 left-4 w-[74px] h-[74px] bg-[#D9FF4D] border-4 border-black rounded-[36px_36px_0_0]"
    ></div>
    <div
      class="absolute top-[58px] left-4 w-[74px] h-[54px] bg-[#D9FF4D] border-4 border-black rounded-[36px]"
    ></div>

    <svg
      class="absolute top-[140px] left-[180px] w-[130px]"
      viewBox="0 0 200 120"
      fill="none"
      aria-hidden="true"
    >
      <path
        d="M10 60c40-70 160-40 160 0M40 42c-22 8-16 48 10 72M60 92l-18 14"
        stroke="#5C74FF"
        stroke-width="8"
        stroke-linecap="round"
        stroke-linejoin="round"
      />
    </svg>

    <div
      class="absolute right-6 bottom-10 w-[70px] h-[70px] bg-[#D9FF4D] border-4 border-black rounded-full"
    ></div>
    <div
      class="absolute right-3 bottom-28 w-[24px] h-[24px] bg-[#D9FF4D] border-4 border-black rounded-full"
    ></div>
    <div
      class="absolute right-20 bottom-4 w-[110px] h-[110px] bg-[#D9FF4D] border-4 border-black rounded-full"
    ></div>
  </div>

  <div class="relative mx-auto max-w-[1100px] px-4 md:mb-24 mb-32">
    <div class="absolute left-6 right-6 -bottom-3 h-6 bg-black rounded-[28px]"></div>

    <div
      class="relative z-10 rounded-[28px] border-4 border-black bg-white shadow-[10px_10px_0_0_#000]"
    >
      <div class="px-6 sm:px-10 pt-8 sm:pt-10 relative">
        <div class="absolute top-12 left-6 hidden sm:block">
          <svg
            width="67"
            height="43"
            viewBox="0 0 67 43"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="w-12 h-auto md:w-16"
          >
            <path
              d="M65.5 2C65.5 13.3133 51.5 19.5 44 23C36.5 26.5 25 30 2 30.5M2 30.5L16.5 20M2 30.5L13 41.5"
              stroke="#4A44F2"
              stroke-width="3"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </div>
        <h1
          class="text-center font-display font-extrabold tracking-wide text-4xl sm:text-5xl md:text-6xl"
        >
          FAQs
        </h1>
        <div class="mx-auto mt-4 h-2 w-40 sm:w-64 rounded-full bg-[#4F67FF]/90"></div>

        <div class="absolute -top-8 right-8 sm:-top-10 sm:right-10">
          <div class="relative">
            <div
              class="h-24 w-24 sm:h-28 sm:w-28 rounded-full border-4 border-black shadow-[6px_6px_0_0_#000] bg-gradient-to-br from-[#C1A5FF] to-[#84A2FF] flex items-center justify-center"
            >
              <span class="text-white drop-shadow-[0_2px_0_#7A7A7A] text-5xl font-extrabold">?</span
              >
            </div>
            <div
              class="absolute -bottom-2 left-5 h-6 w-6 rotate-45 bg-gradient-to-br from-[#C1A5FF] to-[#84A2FF] border-4 border-black"
            ></div>
          </div>
        </div>
      </div>

      <div class="px-6 sm:px-10 pb-2 sm:pb-4 mt-12">
        <div
          role="tablist"
          aria-label="FAQ categories"
          class="flex flex-wrap items-center gap-3 sm:gap-4"
        >
          <button
            role="tab"
            aria-selected="true"
            data-tab="general"
            class="tab-btn rounded-full border-4 border-black bg-[#D9FF4D] px-5 py-2 font-display font-bold shadow-[6px_6px_0_0_#000] focus:outline-none focus:ring-4 focus:ring-black/20"
          >
            General
          </button>
          <button
            role="tab"
            aria-selected="false"
            data-tab="services"
            class="tab-btn rounded-full border-4 border-black bg-white px-5 py-2 font-display font-bold shadow-[6px_6px_0_0_#000] hover:bg-black/5 focus:outline-none focus:ring-4 focus:ring-black/20"
          >
            Work
          </button>
          <button
            role="tab"
            aria-selected="false"
            data-tab="business"
            class="tab-btn rounded-full border-4 border-black bg-white px-5 py-2 font-display font-bold shadow-[6px_6px_0_0_#000] hover:bg-black/5 focus:outline-none focus:ring-4 focus:ring-black/20"
          >
            Family
          </button>
          <button
            role="tab"
            aria-selected="false"
            data-tab="account"
            class="tab-btn rounded-full border-4 border-black bg-white px-5 py-2 font-display font-bold shadow-[6px_6px_0_0_#000] hover:bg-black/5 focus:outline-none focus:ring-4 focus:ring-black/20"
          >
            Vendors
          </button>
        </div>
      </div>

      <div class="px-6 sm:px-10 mt-6 pb-8 sm:pb-10">
        <div class="tab-panel" id="panel-general">
          <ol class="divide-y-4 divide-black">
            <li class="py-5">
              <button
                type="button"
                class="acc-btn group w-full text-left flex items-center gap-4"
                aria-expanded="false"
                aria-controls="a1"
              >
                <span class="font-display font-extrabold text-2xl sm:text-3xl">01</span>
                <span class="font-display text-lg sm:text-2xl font-extrabold leading-tight">
                  What is Zakayo and how does it work?
                </span>
                <span
                  class="shrink-0 ml-auto rounded-full border-4 border-black h-10 w-10 flex items-center justify-center shadow-[6px_6px_0_0_#000] transition-transform group-aria-expanded:rotate-180"
                >
                  <svg
                    class="h-5 w-5"
                    viewBox="0 0 20 20"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.8"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                  >
                    <path d="M5 8l5 5 5-5" />
                  </svg>
                </span>
              </button>
              <div id="a1" class="accordion-panel mt-3" aria-hidden="true">
                <div>
                  <p class="max-w-3xl text-base sm:text-lg leading-relaxed">
                    Zakayo is a single app built for Kenya to manage your <strong>work</strong>,
                    <strong>family</strong>, and <strong>personal</strong>
                    life in one place. It blends productivity tools (lists, notes, projects, calendars)
                    with connectivity tools like a trusted vendor network,
                    <strong>M-Pesa escrow</strong>, and family collaboration—so the same app helps
                    you run payroll at work, coordinate home shopping, or keep private personal
                    tasks. It’s organized into three spaces:
                    <em>Work</em>, <em>Family</em>, and <em>Personal</em>.
                  </p>
                </div>
              </div>
            </li>

            <li class="py-5">
              <button
                type="button"
                class="acc-btn group w-full text-left flex items-center gap-4"
                aria-expanded="false"
                aria-controls="a2"
              >
                <span class="font-display font-extrabold text-2xl sm:text-3xl">02</span>
                <span class="font-display text-lg sm:text-2xl font-extrabold leading-tight">
                  How does Zakayo build trust and safety?
                </span>
                <span
                  class="shrink-0 ml-auto rounded-full border-4 border-black h-10 w-10 flex items-center justify-center shadow-[6px_6px_0_0_#000] transition-transform group-aria-expanded:rotate-180"
                >
                  <svg
                    class="h-5 w-5"
                    viewBox="0 0 20 20"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.8"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                  >
                    <path d="M5 8l5 5 5-5" />
                  </svg>
                </span>
              </button>
              <div id="a2" class="accordion-panel mt-3" aria-hidden="true">
                <div>
                  <p class="max-w-3xl text-base sm:text-lg leading-relaxed">
                    Vendors and people are connected through <strong>degrees of separation</strong
                    >—your own trusted circle (1st degree), your colleagues’ and family’s trusted
                    vendors (2nd), and trusted vendors of those connections (3rd). Requests you
                    broadcast reach these verified circles first, helping you discover reliable
                    local providers (from Mama Amina’s produce to clinics) while payments can be
                    protected with <strong>M-Pesa escrow</strong>.
                  </p>
                </div>
              </div>
            </li>
          </ol>
        </div>

        <div class="tab-panel hidden" id="panel-services">
          <ol class="divide-y-4 divide-black">
            <li class="py-5">
              <button
                class="acc-btn group w-full text-left flex items-center gap-4"
                aria-expanded="false"
                aria-controls="s1"
              >
                <span class="font-display font-extrabold text-2xl sm:text-3xl">01</span>
                <span class="font-display text-lg sm:text-2xl font-extrabold leading-tight">
                  How does Payroll &amp; Compliance work in Zakayo?
                </span>
                <span
                  class="shrink-0 ml-auto rounded-full border-4 border-black h-10 w-10 flex items-center justify-center shadow-[6px_6px_0_0_#000] transition-transform group-aria-expanded:rotate-180"
                >
                  <svg
                    class="h-5 w-5"
                    viewBox="0 0 20 20"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.8"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                  >
                    <path d="M5 8l5 5 5-5" />
                  </svg>
                </span>
              </button>
              <div id="s1" class="accordion-panel mt-3" aria-hidden="true">
                <div>
                  <p class="max-w-3xl text-base sm:text-lg leading-relaxed">
                    Store employee records, automate monthly salary calculations (PAYE, NHIF, NSSF),
                    generate payslips, and disburse salaries <strong>via M-Pesa or bank</strong>.
                    Approved leave updates payroll automatically. Zakayo produces exportable
                    compliance reports (PAYE/NHIF/NSSF) today, and is built to support
                    <em>one-click filing</em> as official APIs become available.
                  </p>
                </div>
              </div>
            </li>
            <li class="py-5">
              <button
                class="acc-btn group w-full text-left flex items-center gap-4"
                aria-expanded="false"
                aria-controls="s2"
              >
                <span class="font-display font-extrabold text-2xl sm:text-3xl">02</span>
                <span class="font-display text-lg sm:text-2xl font-extrabold leading-tight">
                  How do Procurement requests and quotes work?
                </span>
                <span
                  class="shrink-0 ml-auto rounded-full border-4 border-black h-10 w-10 flex items-center justify-center shadow-[6px_6px_0_0_#000] transition-transform group-aria-expanded:rotate-180"
                >
                  <svg
                    class="h-5 w-5"
                    viewBox="0 0 20 20"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.8"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                  >
                    <path d="M5 8l5 5 5-5" />
                  </svg>
                </span>
              </button>
              <div id="s2" class="accordion-panel mt-3" aria-hidden="true">
                <div>
                  <p class="max-w-3xl text-base sm:text-lg leading-relaxed">
                    Create a request (e.g., laptops, chairs). Zakayo broadcasts it to trusted
                    vendors in your network, who submit instant quotes. Managers compare
                    transparently, approve, and pay with <strong>M-Pesa escrow</strong> for added protection.
                  </p>
                </div>
              </div>
            </li>
          </ol>
        </div>

        <div class="tab-panel hidden" id="panel-business">
          <ol class="divide-y-4 divide-black">
            <li class="py-5">
              <button
                class="acc-btn group w-full text-left flex items-center gap-4"
                aria-expanded="false"
                aria-controls="b1"
              >
                <span class="font-display font-extrabold text-2xl sm:text-3xl">01</span>
                <span class="font-display text-lg sm:text-2xl font-extrabold leading-tight">
                  How do families use Zakayo day-to-day?
                </span>
                <span
                  class="shrink-0 ml-auto rounded-full border-4 border-black h-10 w-10 flex items-center justify-center shadow-[6px_6px_0_0_#000] transition-transform group-aria-expanded:rotate-180"
                >
                  <svg
                    class="h-5 w-5"
                    viewBox="0 0 20 20"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.8"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                  >
                    <path d="M5 8l5 5 5-5" />
                  </svg>
                </span>
              </button>
              <div id="b1" class="accordion-panel mt-3" aria-hidden="true">
                <div>
                  <p class="max-w-3xl text-base sm:text-lg leading-relaxed">
                    Create one or more family spaces (immediate household, parents &amp; siblings,
                    etc.). Share shopping lists, manage school tasks and events on a family
                    calendar, and coordinate projects like healthcare. Broadcast shopping lists to
                    trusted nearby vendors, get quotes, and pay with <strong>M-Pesa escrow</strong
                    >—funds release when goods arrive. Your <em>Personal</em> space stays private for
                    to-dos and appointments, and you can move a personal project into Family or Work
                    when collaboration is needed.
                  </p>
                </div>
              </div>
            </li>
          </ol>
        </div>

        <div class="tab-panel hidden" id="panel-account">
          <ol class="divide-y-4 divide-black">
            <li class="py-5">
              <button
                class="acc-btn group w-full text-left flex items-center gap-4"
                aria-expanded="false"
                aria-controls="c1"
              >
                <span class="font-display font-extrabold text-2xl sm:text-3xl">01</span>
                <span class="font-display text-lg sm:text-2xl font-extrabold leading-tight">
                  Why should vendors join Zakayo?
                </span>
                <span
                  class="shrink-0 ml-auto rounded-full border-4 border-black h-10 w-10 flex items-center justify-center shadow-[6px_6px_0_0_#000] transition-transform group-aria-expanded:rotate-180"
                >
                  <svg
                    class="h-5 w-5"
                    viewBox="0 0 20 20"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2.8"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    aria-hidden="true"
                  >
                    <path d="M5 8l5 5 5-5" />
                  </svg>
                </span>
              </button>
              <div id="c1" class="accordion-panel mt-3" aria-hidden="true">
                <div>
                  <p class="max-w-3xl text-base sm:text-lg leading-relaxed">
                    Vendors (goods, services, and healthcare) get discovered through digital
                    <strong>word-of-mouth</strong>: when users broadcast a need to their 1st–3rd
                    degree circles, trusted vendors can respond with quotes. Service vendors can
                    offer time slots and accept optional
                    <strong>deposits held in M-Pesa escrow</strong> to reduce no-shows—appointments sync
                    to both calendars. Healthcare vendors can link with patients to share records securely,
                    while the patient remains the owner.
                  </p>
                </div>
              </div>
            </li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</section>


<script>
  function initFaq() {
    const tabListeners:any = [];
    const accListeners:any = [];

    // --- Tabs ---
    const tabBtns = Array.from(document.querySelectorAll('.tab-btn'));
    const panels = {
      general: document.getElementById('panel-general'),
      services: document.getElementById('panel-services'),
      business: document.getElementById('panel-business'),
      account: document.getElementById('panel-account'),
    };

    function getButtons(scope = document) {
      return Array.from(scope.querySelectorAll('.acc-btn'));
    }
    function closeAllIn(scope = document) {
      getButtons(scope).forEach((b) => {
        b.setAttribute('aria-expanded', 'false');
        const panel = document.getElementById(b.getAttribute('aria-controls') || '');
        if (panel) panel.setAttribute('aria-hidden', 'true');
      });
    }

    function activateTab(name:any) {
      tabBtns.forEach((btn) => {
        const isActive = btn.dataset.tab === name;
        btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
        btn.classList.toggle('bg-[#D9FF4D]', isActive);
        btn.classList.toggle('bg-white', !isActive);
      });
      Object.entries(panels).forEach(([n, el]) => {
        if (!el) return;
        el.classList.toggle('hidden', n !== name);
        if (n !== name) closeAllIn(el); // ensure no panel stays open when switching tabs
      });
    }

    tabBtns.forEach((btn) => {
      const listener = () => activateTab(btn.dataset.tab || 'general');
      btn.addEventListener('click', listener);
      tabListeners.push({ btn, listener });
    });
    
    activateTab('general'); // default

    // --- Accordion (one open at a time within current tab) ---
    function handleToggle(e:any) {
      const btn = e.currentTarget;
      const container = btn.closest('.tab-panel');
      const targetId = btn.getAttribute('aria-controls') || '';
      const panel = document.getElementById(targetId);
      const willOpen = btn.getAttribute('aria-expanded') !== 'true';

      // close all in the same tab
      closeAllIn(container);

      // open the requested one (if user clicked a closed item)
      if (willOpen && panel) {
        btn.setAttribute('aria-expanded', 'true');
        panel.setAttribute('aria-hidden', 'false');
      }
    }

    function hookup(scope = document) {
      getButtons(scope).forEach((btn) => {
        const panel = document.getElementById(btn.getAttribute('aria-controls') || '');
        if (panel) {
          panel.setAttribute('aria-hidden', 'true');
        }

        // Define listeners
        const clickListener = handleToggle;
        const keyListener = (ev) => {
          if (ev.key === 'Enter' || ev.key === ' ') {
            ev.preventDefault();
            handleToggle({ currentTarget: btn });
          }
        };

        // Add listeners
        btn.addEventListener('click', clickListener);
        btn.addEventListener('keydown', keyListener);

        accListeners.push({ btn, clickListener, keyListener });
      });
    }
    hookup(document);

    return () => {
      // Remove tab listeners
      tabListeners.forEach(({ btn, listener }) => {
        btn.removeEventListener('click', listener);
      });

      // Remove accordion listeners
      accListeners.forEach(({ btn, clickListener, keyListener }) => {
        btn.removeEventListener('click', clickListener);
        btn.removeEventListener('keydown', keyListener);
      });
    };
  }


  let destroyFaq:any = null;

  // Run on initial page load
  document.addEventListener('DOMContentLoaded', () => {
    destroyFaq = initFaq();
  }, { once: true });

  // Run on subsequent page navigations (if using View Transitions)
  document.addEventListener('astro:after-swap', () => {
    if (typeof destroyFaq === 'function') {
      destroyFaq();
    }
    // Re-initialize the scripts for the new page
    destroyFaq = initFaq();
  });

  // Clean up listeners before Astro swaps the page content
  document.addEventListener('astro:before-swap', () => {
    if (typeof destroyFaq === 'function') {
      destroyFaq();
    }
    destroyFaq = null;
  }, { once: true });
</script>